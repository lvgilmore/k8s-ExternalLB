Haproxy reload command

haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -sf $(cat /run/haproxy.pid)

reload keepalived

kill -HUP $(cat /var/run/keepalived.pid)


sample haproxy config
global
        log 127.0.0.1   local0
        log 127.0.0.1   local1 notice
        #log loghost    local0 info
        maxconn 4096
        #chroot /usr/share/haproxy
        user haproxy
        group haproxy
        daemon
        #debug
        #quiet

defaults
        log     global
        mode    http
        option  httplog
        option  dontlognull
        retries 3
        option redispatch
        maxconn 2000
        contimeout      5000
        clitimeout      50000
        srvtimeout      50000


listen am_cluster2
        bind 192.168.1.124:8989
        mode http
        stats enable
        stats uri /stats
        stats realm HAProxy\ Statistics
        stats auth admin:admin


listen am_cluster
        bind 192.168.1.33:80
        mode http
        balance roundrobin
        option httpclose
        option forwardfor
        cookie SERVERNAME insert indirect nocache
        server am-1 192.168.1.124:32116


sample keepalived config
global_defs {
    tlived process identifier
lvs_id haproxy_DH
}
# Script used to check if HAProxy is running
#vrrp_script check_haproxy {
#script "killall -0 haproxy"
#interval 2
#weight 2
#}
# Virtual interface
# The priority specifies the order in which the assigned interface to take over in a failover
vrrp_instance VI_01 {
state MASTER
interface ens33
virtual_router_id 51
priority 101
# The virtual ip address shared between the two loadbalancers
virtual_ipaddress_excluded {
192.168.1.33
192.168.1.36
}
#track_script {
#check_haproxy
#}
}
